<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Solutions to WPA7</title>

<script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R seminar</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Syllabus</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-display"></span>
     
    WPAs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="wpa1.html">WPA 1</a>
    </li>
    <li>
      <a href="wpa2.html">WPA 2</a>
    </li>
    <li>
      <a href="wpa3.html">WPA 3</a>
    </li>
    <li>
      <a href="wpa4.html">WPA 4</a>
    </li>
    <li>
      <a href="wpa5.html">WPA 5</a>
    </li>
    <li>
      <a href="wpa6.html">WPA 6</a>
    </li>
    <li>
      <a href="wpa7.html">WPA 7</a>
    </li>
    <li>
      <a href="wpa8.html">WPA 8</a>
    </li>
    <li>
      <a href="wpa9.html">WPA 9</a>
    </li>
    <li>
      <a href="wpa10.html">WPA 10</a>
    </li>
    <li>
      <a href="final_project.html">Final Project</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-display-arrow-down"></span>
     
    Solutions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="wpa1_solutions.html">WPA 1</a>
    </li>
    <li>
      <a href="wpa2_solutions.html">WPA 2</a>
    </li>
    <li>
      <a href="wpa3_solutions.html">WPA 3</a>
    </li>
    <li>
      <a href="wpa4_solutions.html">WPA 4</a>
    </li>
    <li>
      <a href="wpa5_solutions.html">WPA 5</a>
    </li>
    <li>
      <a href="wpa6_solutions.html">WPA 6</a>
    </li>
    <li>
      <a href="wpa7_solutions.html">WPA 7</a>
    </li>
    <li>
      <a href="wpa8_solutions.html">WPA 8</a>
    </li>
    <li>
      <a href="wpa9_solutions.html">WPA 9</a>
    </li>
    <li>
      <a href="wpa10_solutions.html">WPA 10</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Solutions to WPA7</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#now-its-your-turn">4. Now it’s your turn</a>
<ul>
<li><a href="#datafile-description">Datafile description</a></li>
</ul></li>
</ul>
</div>

<div id="now-its-your-turn" class="section level1">
<h1>4. Now it’s your turn</h1>
<p>In this WPA, you will analyze data from another fake study. In this fake study the researchers were interested in whether playing video games had cognitive benefits compared to other leisure activities. In the study, 90 University students were asked to do one of 3 leisure activities for 1 hour a day for the next month. 30 participants were asked to play visio games, 30 to read and 30 to juggle. At the end of the month each participant did 3 cognitive tests, a problem solving test (<strong>logic</strong>) and a reflex/response test (<strong>reflex</strong>) and a written comprehension test (<strong>comprehension</strong>).</p>
<div id="datafile-description" class="section level2">
<h2>Datafile description</h2>
<p>The data file has 90 rows and 7 columns. Here are the columns</p>
<ul>
<li><p><code>id</code>: The participant ID</p></li>
<li><p><code>age</code>: The age of the participant</p></li>
<li><p><code>gender</code>: The gender of the particiant</p></li>
<li><p><code>activity</code>: Which leisure activity the participant was assigned for the last month (“reading”, “juggling”, “gaming”)</p></li>
<li><p><code>logic</code>: Score out of 120 on a problem solving task. Higher is better.</p></li>
<li><p><code>reflex</code>: Score out of 25 on a reflex test. Higher indicates faster reflexes.</p></li>
<li><p><code>comprehension</code>: Score out of 100 on a reading comprehension test. Higher is better.</p></li>
</ul>
<p><strong>Task A</strong></p>
<ol style="list-style-type: decimal">
<li>Load the <code>data_wpa7.txt</code> dataset in R (find them on Github) and save it as a new object called <code>leisure</code>. Inspect the dataset first.</li>
</ol>
<pre class="r"><code>library(tidyverse)

leisure = read_delim(&#39;https://raw.githubusercontent.com/laurafontanesi/r-seminar22/master/data/data_wpa7.txt&#39;, delim=&#39;\t&#39;)</code></pre>
<pre><code>## 
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   index = col_double(),
##   id = col_double(),
##   age = col_double(),
##   gender = col_character(),
##   activity = col_character(),
##   logic = col_double(),
##   reflex = col_double(),
##   comprehension = col_double()
## )</code></pre>
<pre class="r"><code>head(leisure)</code></pre>
<pre><code>## # A tibble: 6 x 8
##   index    id   age gender activity logic reflex comprehension
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;         &lt;dbl&gt;
## 1     1     1    26 m      reading     88   13.7            72
## 2     2     2    31 m      reading     85   11.8            83
## 3     3     3    38 m      reading     82    5.8            67
## 4     4     4    24 m      reading    102   18              66
## 5     5     5    30 f      reading     48   14              62
## 6     6     6    31 m      reading     61   14.1            58</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Write a function called <code>feed_me()</code> that takes a string <code>food</code> as an argument, and returns (in case <code>food = 'pizza'</code>) the sentence “I love to eat pizza”. Try your function by running <code>feed_me("apples")</code> (it should then return “I love to eat apples”).</li>
</ol>
<pre class="r"><code>feed_me = function(food) {
    print(paste(&quot;I love to eat&quot;, food))
}

feed_me(&quot;apples&quot;)</code></pre>
<pre><code>## [1] &quot;I love to eat apples&quot;</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><p>Without using the <code>mean()</code> function, calculate the mean of the vector <code>vec_1 = seq(1, 100, 5)</code>.</p></li>
<li><p>Write a function called <code>my_mean()</code> that takes a vector <code>x</code> as an argument, and returns the mean of the vector <code>x</code>. Use your code for task A3 as your starting point. Test it on the vector from task A3.</p></li>
</ol>
<pre class="r"><code>vec_1 = seq(1, 100, 5)

my_mean = function(x) {
    return(sum(x)/length(x))
}

my_mean(vec_1)</code></pre>
<pre><code>## [1] 48.5</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Try your <code>my_mean()</code> function to calculate the mean ‘logic’ rating of participants in the <code>leisure</code> dataset and compare the result to the built-in <code>mean()</code> function (using <code>==</code>) to make sure you get the same result.</li>
</ol>
<pre class="r"><code>my_mean(leisure$logic) == mean(leisure$logic)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Create a loop that prints the squares of integers from 1 to 10.</li>
</ol>
<pre class="r"><code>for (i in 1:10) {
    print(i**2)
}</code></pre>
<pre><code>## [1] 1
## [1] 4
## [1] 9
## [1] 16
## [1] 25
## [1] 36
## [1] 49
## [1] 64
## [1] 81
## [1] 100</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>Modify the previous code so that it saves the squared integers as a vector called <code>squares</code>. You’ll need to pre-create a vector, and use indexing to update it.</li>
</ol>
<pre class="r"><code>squares = rep(NA, 10)

for (i in 1:10) {
    squares[i] = i**2
}

print(squares)</code></pre>
<pre><code>##  [1]   1   4   9  16  25  36  49  64  81 100</code></pre>
<p><strong>Task B</strong></p>
<ol style="list-style-type: decimal">
<li>Create a function called <code>standardize</code>, that, given an input vector, returns its standardized version. Remember that to normalize a score, also called z-transforming it, you first subtract the mean score from the individual scores and then divide by the standard deviation.</li>
</ol>
<pre class="r"><code>standardize = function(x) {
    demeaned = x - mean(x, na.rm = TRUE)
    st_deviation = sd(x, na.rm = TRUE)
    z_score = demeaned/st_deviation
    
    return (z_score)
}</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Create a copy of the <code>leisure</code> dataset. Call this copy <code>z_leisure</code>. Normalise the <code>logic</code>, <code>reflex</code>, <code>age</code> and <code>comprehension</code> columns using the <code>standardize</code> function using a <code>for</code> loop. In each iteration of the loop, you should standardize one of these 4 columns. You can create a vector first, called <code>columns_to_standardize</code> where you store these columns and use them later in the loop. You should not add them as additional columns, but overwrite the original columns.</li>
</ol>
<pre class="r"><code>z_leisure = leisure

columns_to_standardize = c(&quot;logic&quot;, &quot;reflex&quot;, &quot;age&quot;, &quot;comprehension&quot;)

for (col in columns_to_standardize) {
    z_leisure[,col] = standardize(pull(leisure[,col])) # NOTE: the pull function is the safest way to get a vector out of a tibble
}

head(z_leisure)</code></pre>
<pre><code>## # A tibble: 6 x 8
##   index    id     age gender activity  logic reflex comprehension
##   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;         &lt;dbl&gt;
## 1     1     1 -0.683  m      reading   1.14  -0.424        0.576 
## 2     2     2  0.190  m      reading   0.962 -1.02         1.29  
## 3     3     3  1.41   m      reading   0.785 -2.89         0.252 
## 4     4     4 -1.03   m      reading   1.97   0.920        0.187 
## 5     5     5  0.0155 f      reading  -1.23  -0.330       -0.0728
## 6     6     6  0.190  m      reading  -0.457 -0.299       -0.332</code></pre>
<p><strong>Task C</strong></p>
<ol style="list-style-type: decimal">
<li>Create a scatterplot of <code>age</code> and <code>reflex</code> of participants in the <code>leisure</code> datset. Cutomise it and add a regression line.</li>
</ol>
<pre class="r"><code>ggplot(data = leisure, mapping = aes(x = age, y = reflex)) + 
    geom_point(alpha = 0.2, size= 3) +
    geom_smooth(method = lm, color=&#39;indianred&#39;) +
    labs(x=&#39;Age&#39;, y=&#39;Reflex&#39;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="wpa7_solutions_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Create a function called <code>my_plot()</code> that takes arguments <code>x</code> and <code>y</code> and returns a customised scatterplot with your customizations and the regression line.</li>
</ol>
<pre class="r"><code>my_plot = function(x, y) {
    g = ggplot(mapping = aes(x = x, y = y)) + 
        geom_point(alpha = 0.2, size= 3) +
        geom_smooth(method = lm, color=&#39;indianred&#39;)
    
    return(g)
}</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Now test your <code>my_plot()</code> function on the <code>age</code> and <code>reflex</code> of participants in the <code>leisure</code> dataset.</li>
</ol>
<pre class="r"><code>my_plot(leisure$age, leisure$reflex)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="wpa7_solutions_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p><strong>Task D</strong></p>
<ol style="list-style-type: decimal">
<li>Create a loop that returns the sum of the vector <code>1:10</code>. (i.e. Don’t use the existing <code>sum</code> function).</li>
</ol>
<pre class="r"><code>final_sum = 0

for (i in 1:10) {
    final_sum = final_sum + i
    print(final_sum)
}</code></pre>
<pre><code>## [1] 1
## [1] 3
## [1] 6
## [1] 10
## [1] 15
## [1] 21
## [1] 28
## [1] 36
## [1] 45
## [1] 55</code></pre>
<pre class="r"><code>final_sum</code></pre>
<pre><code>## [1] 55</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Use this loop to create a function, called <code>my_sum</code> that returns the sum of any vector x. Test it on the <code>logic</code> ratings.</li>
</ol>
<pre class="r"><code>my_sum = function(x) {
    final_sum = 0
    
    for (i in x){
        final_sum = final_sum + i
    }
    
    return(final_sum)
}

my_sum(leisure$logic)</code></pre>
<pre><code>## [1] 6186</code></pre>
<pre class="r"><code>sum(leisure$logic)</code></pre>
<pre><code>## [1] 6186</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Modify the function you created in task D2, to instead calculate the mean of a vector. Call this new function <code>my_mean2</code> and compare it to both the <code>my_mean</code> function you created, and the in-built <code>mean</code> function. (Bonus: Can you also think of a way to do this without using the the length function)</li>
</ol>
<pre class="r"><code>my_mean2 = function(x) {
    final_sum = 0
    final_length = 0
    
    for (i in x){
      final_sum = final_sum + i
      final_length = final_length + 1
    }
    
    return(final_sum/final_length)
}

my_mean(leisure$logic)</code></pre>
<pre><code>## [1] 68.73333</code></pre>
<pre class="r"><code>my_mean2(leisure$logic)</code></pre>
<pre><code>## [1] 68.73333</code></pre>
<pre class="r"><code>mean(leisure$logic)</code></pre>
<pre><code>## [1] 68.73333</code></pre>
<p><strong>Task E</strong></p>
<ol style="list-style-type: decimal">
<li>What is the probability of getting a significant p-value if the null hypothesis is true? Test this by conducting the following simulation:</li>
</ol>
<ul>
<li>Create a vector called <code>p_values</code> with 100 NA values.</li>
<li>Draw a sample of size 10 from a normal distribution with mean = 0 and standard deviation = 1.</li>
<li>Do a one-sample t-test testing if the mean of the distribution is different from 0. Save the p-value from this test in the 1st position of <code>p_values</code>.</li>
<li>Repeat these steps with a loop to fill <code>p_values</code> with 100 p-values.</li>
<li>Create a histogram of <code>p_values</code> and calculate the proportion of p-values that are significant at the .05 level.</li>
</ul>
<pre class="r"><code>p_values = rep(NA, 100)

sample = rnorm(mean=0, sd=1, n=10)

p_values[1] = t.test(sample)$p.value

p_values[1]</code></pre>
<pre><code>## [1] 0.7979984</code></pre>
<pre class="r"><code>p_values = rep(NA, 100)

for (i in 1:100) {
    
    sample = rnorm(mean=0, sd=1, n=10)

    p_values[i] = t.test(sample)$p.value
}</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Create a function called <code>p_simulation</code> with 4 arguments: <code>sim</code>: the number of simulations, <code>samplesize</code>: the sample size, <code>mu_true</code>: the true mean, and <code>sd_true</code>: the true standard deviation. Your function should repeat the simulation from the previous question with the given arguments. That is, it should calculate <code>sim</code> p-values testing whether <code>samplesize</code> samples from a normal distribution with mean = <code>mu_true</code> and standard deviation = <code>sd_true</code> is significantly different from 0. The function should return a vector of p-values.</li>
</ol>
<p><em>Note</em>: to get the p-value of a t-test: p_value = t.test(x)$p.value # Calculate the p.vale for the sample x</p>
<pre class="r"><code>p_simulation = function(sim, samplesize, mu_true, sd_true) {
    
    p_values = rep(NA, sim)

    for (i in 1:sim) {
        sample = rnorm(mean=mu_true, sd=sd_true, n=samplesize)
        p_values[i] = t.test(sample)$p.value
    }
    return(p_values)
}

p_values = p_simulation(sim=1000, samplesize=100, mu_true=0, sd_true=1)

mean(p_values &lt; .05)*100</code></pre>
<pre><code>## [1] 6.4</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
