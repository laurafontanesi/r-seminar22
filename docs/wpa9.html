<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Multiple regression and ANOVA</title>

<script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R seminar</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Syllabus</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-display"></span>
     
    WPAs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="wpa1.html">WPA 1</a>
    </li>
    <li>
      <a href="wpa2.html">WPA 2</a>
    </li>
    <li>
      <a href="wpa3.html">WPA 3</a>
    </li>
    <li>
      <a href="wpa4.html">WPA 4</a>
    </li>
    <li>
      <a href="wpa5.html">WPA 5</a>
    </li>
    <li>
      <a href="wpa6.html">WPA 6</a>
    </li>
    <li>
      <a href="wpa7.html">WPA 7</a>
    </li>
    <li>
      <a href="wpa8.html">WPA 8</a>
    </li>
    <li>
      <a href="wpa9.html">WPA 9</a>
    </li>
    <li>
      <a href="wpa10.html">WPA 10</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-display-arrow-down"></span>
     
    Solutions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="wpa1_solutions.html">WPA 1</a>
    </li>
    <li>
      <a href="wpa2_solutions.html">WPA 2</a>
    </li>
    <li>
      <a href="wpa3_solutions.html">WPA 3</a>
    </li>
    <li>
      <a href="wpa4_solutions.html">WPA 4</a>
    </li>
    <li>
      <a href="wpa5_solutions.html">WPA 5</a>
    </li>
    <li>
      <a href="wpa6_solutions.html">WPA 6</a>
    </li>
    <li>
      <a href="wpa7_solutions.html">WPA 7</a>
    </li>
    <li>
      <a href="wpa8_solutions.html">WPA 8</a>
    </li>
    <li>
      <a href="wpa9_solutions.html">WPA 9</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Multiple regression and ANOVA</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#multiple-linear-regression-model">1. Multiple linear regression model</a>
<ul>
<li><a href="#model-fitting">Model fitting</a>
<ul>
<li><a href="#main-effects-model">Main effects model:</a></li>
<li><a href="#full-model-including-also-interactions-effects">Full model (including also interactions effects):</a></li>
</ul></li>
<li><a href="#how-to-visualize-it">How to visualize it?</a></li>
<li><a href="#multicollinearity-checks">Multicollinearity checks</a>
<ul>
<li><a href="#hypothesis-tests-for-all-pairwise-correlations">Hypothesis tests for all pairwise correlations:</a></li>
</ul></li>
<li><a href="#calculating-standardised-regression-coefficients">Calculating standardised regression coefficients</a></li>
</ul></li>
<li><a href="#anova">2. ANOVA</a>
<ul>
<li><a href="#general-linear-models">General linear models</a></li>
<li><a href="#when-to-use-anovalinear-regression">When to use ANOVA/linear regression?</a></li>
<li><a href="#different-types-of-anovas">Different types of ANOVAS</a></li>
<li><a href="#anovas-assumptions">ANOVA’s assumptions</a></li>
<li><a href="#model-checking-and-fitting">Model checking and fitting</a></li>
<li><a href="#tukeys-honest-significant-difference-test">Tukey’s honest significant difference test</a></li>
</ul></li>
<li><a href="#now-its-your-turn">3. Now it’s your turn</a>
<ul>
<li><a href="#student-performance">Student Performance</a></li>
<li><a href="#submit-your-assignment">Submit your assignment</a></li>
</ul></li>
</ul>
</div>

<div id="multiple-linear-regression-model" class="section level1">
<h1>1. Multiple linear regression model</h1>
<p>Last week we looked at linear models with 1 predictor (either continuous or categorical with 2 levels). Now we are going to extend this to linear models with more than 1 predictor.</p>
<p>We have already seen the assumptions of multiple linear regression last week. They are essentially the same as for simple linear regression but now we should also check that the predictors are not correlated.</p>
<p>Open RStudio.</p>
<p>Open a new R script in R and <strong>save it as</strong> <code>wpa_9_LastFirst.R</code> (where Last and First is your last and first name).</p>
<p>Careful about: capitalizing, last and first name order, and using <code>_</code> instead of <code>-</code>.</p>
<p>At the top of your script, write the following (<strong>with appropriate changes</strong>):</p>
<pre><code># Assignment: WPA 9
# Name: Laura Fontanesi
# Date: 9 May 2022</code></pre>
<div id="model-fitting" class="section level2">
<h2>Model fitting</h2>
<p>Model fit can be achieved as in simple linear regression using <code>lm()</code>.</p>
<p>the only thing to take into account is how to change the formula argument:</p>
<ul>
<li><code>outcome ~ predictor1 + predictor2</code>: tests main effects only of these two predictors</li>
<li><code>outcome ~ predictor1 * predictor2</code>: tests all main effects and the interaction effect of these two predictors</li>
<li><code>outcome ~ predictor1 * predictor2 * predictor3</code>: tests all main effects and all interaction effect of these three predictors</li>
<li><code>outcome ~ predictor1 + predictor2 + predictor3 + predictor1*predictor2</code>: tests main all three main effects and only the interaction effect of the first and second predictor</li>
</ul>
<p>Download the <code>house_prices.csv</code> dataset from the <a href="%22https://github.com/laurafontanesi/r-seminar22/tree/main/data%22">Github folder</a> and load it in R:</p>
<pre class="r"><code>library(tidyverse)

house_prices = read_csv(&#39;data/house_prices.csv&#39;)</code></pre>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   .default = col_character(),
##   Id = col_double(),
##   MSSubClass = col_double(),
##   LotFrontage = col_double(),
##   LotArea = col_double(),
##   OverallQual = col_double(),
##   OverallCond = col_double(),
##   YearBuilt = col_double(),
##   YearRemodAdd = col_double(),
##   MasVnrArea = col_double(),
##   BsmtFinSF1 = col_double(),
##   BsmtFinSF2 = col_double(),
##   BsmtUnfSF = col_double(),
##   TotalBsmtSF = col_double(),
##   `1stFlrSF` = col_double(),
##   `2ndFlrSF` = col_double(),
##   LowQualFinSF = col_double(),
##   GrLivArea = col_double(),
##   BsmtFullBath = col_double(),
##   BsmtHalfBath = col_double(),
##   FullBath = col_double()
##   # ... with 18 more columns
## )
## ℹ Use `spec()` for the full column specifications.</code></pre>
<pre class="r"><code>glimpse(house_prices)</code></pre>
<pre><code>## Rows: 1,460
## Columns: 81
## $ Id            &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1…
## $ MSSubClass    &lt;dbl&gt; 60, 20, 60, 70, 60, 50, 20, 60, 50, 190, 20, 60, 20, 20,…
## $ MSZoning      &lt;chr&gt; &quot;RL&quot;, &quot;RL&quot;, &quot;RL&quot;, &quot;RL&quot;, &quot;RL&quot;, &quot;RL&quot;, &quot;RL&quot;, &quot;RL&quot;, &quot;RM&quot;, &quot;R…
## $ LotFrontage   &lt;dbl&gt; 65, 80, 68, 60, 84, 85, 75, NA, 51, 50, 70, 85, NA, 91, …
## $ LotArea       &lt;dbl&gt; 8450, 9600, 11250, 9550, 14260, 14115, 10084, 10382, 612…
## $ Street        &lt;chr&gt; &quot;Pave&quot;, &quot;Pave&quot;, &quot;Pave&quot;, &quot;Pave&quot;, &quot;Pave&quot;, &quot;Pave&quot;, &quot;Pave&quot;, …
## $ Alley         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ LotShape      &lt;chr&gt; &quot;Reg&quot;, &quot;Reg&quot;, &quot;IR1&quot;, &quot;IR1&quot;, &quot;IR1&quot;, &quot;IR1&quot;, &quot;Reg&quot;, &quot;IR1&quot;, …
## $ LandContour   &lt;chr&gt; &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, &quot;Lvl&quot;, …
## $ Utilities     &lt;chr&gt; &quot;AllPub&quot;, &quot;AllPub&quot;, &quot;AllPub&quot;, &quot;AllPub&quot;, &quot;AllPub&quot;, &quot;AllPu…
## $ LotConfig     &lt;chr&gt; &quot;Inside&quot;, &quot;FR2&quot;, &quot;Inside&quot;, &quot;Corner&quot;, &quot;FR2&quot;, &quot;Inside&quot;, &quot;I…
## $ LandSlope     &lt;chr&gt; &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, &quot;Gtl&quot;, …
## $ Neighborhood  &lt;chr&gt; &quot;CollgCr&quot;, &quot;Veenker&quot;, &quot;CollgCr&quot;, &quot;Crawfor&quot;, &quot;NoRidge&quot;, &quot;…
## $ Condition1    &lt;chr&gt; &quot;Norm&quot;, &quot;Feedr&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;,…
## $ Condition2    &lt;chr&gt; &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, &quot;Norm&quot;, …
## $ BldgType      &lt;chr&gt; &quot;1Fam&quot;, &quot;1Fam&quot;, &quot;1Fam&quot;, &quot;1Fam&quot;, &quot;1Fam&quot;, &quot;1Fam&quot;, &quot;1Fam&quot;, …
## $ HouseStyle    &lt;chr&gt; &quot;2Story&quot;, &quot;1Story&quot;, &quot;2Story&quot;, &quot;2Story&quot;, &quot;2Story&quot;, &quot;1.5Fi…
## $ OverallQual   &lt;dbl&gt; 7, 6, 7, 7, 8, 5, 8, 7, 7, 5, 5, 9, 5, 7, 6, 7, 6, 4, 5,…
## $ OverallCond   &lt;dbl&gt; 5, 8, 5, 5, 5, 5, 5, 6, 5, 6, 5, 5, 6, 5, 5, 8, 7, 5, 5,…
## $ YearBuilt     &lt;dbl&gt; 2003, 1976, 2001, 1915, 2000, 1993, 2004, 1973, 1931, 19…
## $ YearRemodAdd  &lt;dbl&gt; 2003, 1976, 2002, 1970, 2000, 1995, 2005, 1973, 1950, 19…
## $ RoofStyle     &lt;chr&gt; &quot;Gable&quot;, &quot;Gable&quot;, &quot;Gable&quot;, &quot;Gable&quot;, &quot;Gable&quot;, &quot;Gable&quot;, &quot;G…
## $ RoofMatl      &lt;chr&gt; &quot;CompShg&quot;, &quot;CompShg&quot;, &quot;CompShg&quot;, &quot;CompShg&quot;, &quot;CompShg&quot;, &quot;…
## $ Exterior1st   &lt;chr&gt; &quot;VinylSd&quot;, &quot;MetalSd&quot;, &quot;VinylSd&quot;, &quot;Wd Sdng&quot;, &quot;VinylSd&quot;, &quot;…
## $ Exterior2nd   &lt;chr&gt; &quot;VinylSd&quot;, &quot;MetalSd&quot;, &quot;VinylSd&quot;, &quot;Wd Shng&quot;, &quot;VinylSd&quot;, &quot;…
## $ MasVnrType    &lt;chr&gt; &quot;BrkFace&quot;, &quot;None&quot;, &quot;BrkFace&quot;, &quot;None&quot;, &quot;BrkFace&quot;, &quot;None&quot;,…
## $ MasVnrArea    &lt;dbl&gt; 196, 0, 162, 0, 350, 0, 186, 240, 0, 0, 0, 286, 0, 306, …
## $ ExterQual     &lt;chr&gt; &quot;Gd&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;T…
## $ ExterCond     &lt;chr&gt; &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;T…
## $ Foundation    &lt;chr&gt; &quot;PConc&quot;, &quot;CBlock&quot;, &quot;PConc&quot;, &quot;BrkTil&quot;, &quot;PConc&quot;, &quot;Wood&quot;, &quot;…
## $ BsmtQual      &lt;chr&gt; &quot;Gd&quot;, &quot;Gd&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;Gd&quot;, &quot;Ex&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;T…
## $ BsmtCond      &lt;chr&gt; &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;T…
## $ BsmtExposure  &lt;chr&gt; &quot;No&quot;, &quot;Gd&quot;, &quot;Mn&quot;, &quot;No&quot;, &quot;Av&quot;, &quot;No&quot;, &quot;Av&quot;, &quot;Mn&quot;, &quot;No&quot;, &quot;N…
## $ BsmtFinType1  &lt;chr&gt; &quot;GLQ&quot;, &quot;ALQ&quot;, &quot;GLQ&quot;, &quot;ALQ&quot;, &quot;GLQ&quot;, &quot;GLQ&quot;, &quot;GLQ&quot;, &quot;ALQ&quot;, …
## $ BsmtFinSF1    &lt;dbl&gt; 706, 978, 486, 216, 655, 732, 1369, 859, 0, 851, 906, 99…
## $ BsmtFinType2  &lt;chr&gt; &quot;Unf&quot;, &quot;Unf&quot;, &quot;Unf&quot;, &quot;Unf&quot;, &quot;Unf&quot;, &quot;Unf&quot;, &quot;Unf&quot;, &quot;BLQ&quot;, …
## $ BsmtFinSF2    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
## $ BsmtUnfSF     &lt;dbl&gt; 150, 284, 434, 540, 490, 64, 317, 216, 952, 140, 134, 17…
## $ TotalBsmtSF   &lt;dbl&gt; 856, 1262, 920, 756, 1145, 796, 1686, 1107, 952, 991, 10…
## $ Heating       &lt;chr&gt; &quot;GasA&quot;, &quot;GasA&quot;, &quot;GasA&quot;, &quot;GasA&quot;, &quot;GasA&quot;, &quot;GasA&quot;, &quot;GasA&quot;, …
## $ HeatingQC     &lt;chr&gt; &quot;Ex&quot;, &quot;Ex&quot;, &quot;Ex&quot;, &quot;Gd&quot;, &quot;Ex&quot;, &quot;Ex&quot;, &quot;Ex&quot;, &quot;Ex&quot;, &quot;Gd&quot;, &quot;E…
## $ CentralAir    &lt;chr&gt; &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;…
## $ Electrical    &lt;chr&gt; &quot;SBrkr&quot;, &quot;SBrkr&quot;, &quot;SBrkr&quot;, &quot;SBrkr&quot;, &quot;SBrkr&quot;, &quot;SBrkr&quot;, &quot;S…
## $ `1stFlrSF`    &lt;dbl&gt; 856, 1262, 920, 961, 1145, 796, 1694, 1107, 1022, 1077, …
## $ `2ndFlrSF`    &lt;dbl&gt; 854, 0, 866, 756, 1053, 566, 0, 983, 752, 0, 0, 1142, 0,…
## $ LowQualFinSF  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ GrLivArea     &lt;dbl&gt; 1710, 1262, 1786, 1717, 2198, 1362, 1694, 2090, 1774, 10…
## $ BsmtFullBath  &lt;dbl&gt; 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1,…
## $ BsmtHalfBath  &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ FullBath      &lt;dbl&gt; 2, 2, 2, 1, 2, 1, 2, 2, 2, 1, 1, 3, 1, 2, 1, 1, 1, 2, 1,…
## $ HalfBath      &lt;dbl&gt; 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1,…
## $ BedroomAbvGr  &lt;dbl&gt; 3, 3, 3, 3, 4, 1, 3, 3, 2, 2, 3, 4, 2, 3, 2, 2, 2, 2, 3,…
## $ KitchenAbvGr  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1,…
## $ KitchenQual   &lt;chr&gt; &quot;Gd&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;Gd&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;T…
## $ TotRmsAbvGrd  &lt;dbl&gt; 8, 6, 6, 7, 9, 5, 7, 7, 8, 5, 5, 11, 4, 7, 5, 5, 5, 6, 6…
## $ Functional    &lt;chr&gt; &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, &quot;Typ&quot;, …
## $ Fireplaces    &lt;dbl&gt; 0, 1, 1, 1, 1, 0, 1, 2, 2, 2, 0, 2, 0, 1, 1, 0, 1, 0, 0,…
## $ FireplaceQu   &lt;chr&gt; NA, &quot;TA&quot;, &quot;TA&quot;, &quot;Gd&quot;, &quot;TA&quot;, NA, &quot;Gd&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, …
## $ GarageType    &lt;chr&gt; &quot;Attchd&quot;, &quot;Attchd&quot;, &quot;Attchd&quot;, &quot;Detchd&quot;, &quot;Attchd&quot;, &quot;Attch…
## $ GarageYrBlt   &lt;dbl&gt; 2003, 1976, 2001, 1998, 2000, 1993, 2004, 1973, 1931, 19…
## $ GarageFinish  &lt;chr&gt; &quot;RFn&quot;, &quot;RFn&quot;, &quot;RFn&quot;, &quot;Unf&quot;, &quot;RFn&quot;, &quot;Unf&quot;, &quot;RFn&quot;, &quot;RFn&quot;, …
## $ GarageCars    &lt;dbl&gt; 2, 2, 2, 3, 3, 2, 2, 2, 2, 1, 1, 3, 1, 3, 1, 2, 2, 2, 2,…
## $ GarageArea    &lt;dbl&gt; 548, 460, 608, 642, 836, 480, 636, 484, 468, 205, 384, 7…
## $ GarageQual    &lt;chr&gt; &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;Fa&quot;, &quot;G…
## $ GarageCond    &lt;chr&gt; &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;TA&quot;, &quot;T…
## $ PavedDrive    &lt;chr&gt; &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;…
## $ WoodDeckSF    &lt;dbl&gt; 0, 298, 0, 0, 192, 40, 255, 235, 90, 0, 0, 147, 140, 160…
## $ OpenPorchSF   &lt;dbl&gt; 61, 0, 42, 35, 84, 30, 57, 204, 0, 4, 0, 21, 0, 33, 213,…
## $ EnclosedPorch &lt;dbl&gt; 0, 0, 0, 272, 0, 0, 0, 228, 205, 0, 0, 0, 0, 0, 176, 0, …
## $ `3SsnPorch`   &lt;dbl&gt; 0, 0, 0, 0, 0, 320, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
## $ ScreenPorch   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 176, 0, 0, 0, 0, 0, …
## $ PoolArea      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ PoolQC        &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ Fence         &lt;chr&gt; NA, NA, NA, NA, NA, &quot;MnPrv&quot;, NA, NA, NA, NA, NA, NA, NA,…
## $ MiscFeature   &lt;chr&gt; NA, NA, NA, NA, NA, &quot;Shed&quot;, NA, &quot;Shed&quot;, NA, NA, NA, NA, …
## $ MiscVal       &lt;dbl&gt; 0, 0, 0, 0, 0, 700, 0, 350, 0, 0, 0, 0, 0, 0, 0, 0, 700,…
## $ MoSold        &lt;dbl&gt; 2, 5, 9, 2, 12, 10, 8, 11, 4, 1, 2, 7, 9, 8, 5, 7, 3, 10…
## $ YrSold        &lt;dbl&gt; 2008, 2007, 2008, 2006, 2008, 2009, 2007, 2009, 2008, 20…
## $ SaleType      &lt;chr&gt; &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;WD&quot;, &quot;W…
## $ SaleCondition &lt;chr&gt; &quot;Normal&quot;, &quot;Normal&quot;, &quot;Normal&quot;, &quot;Abnorml&quot;, &quot;Normal&quot;, &quot;Norm…
## $ SalePrice     &lt;dbl&gt; 208500, 181500, 223500, 140000, 250000, 143000, 307000, …</code></pre>
<p>GrLivArea: Above grade (ground) living area square feet</p>
<p>LotArea: Lot size in square feet</p>
<p>GarageArea: Size of garage in square feet</p>
<div id="main-effects-model" class="section level3">
<h3>Main effects model:</h3>
<pre class="r"><code>model_fit = lm(SalePrice ~ LotArea + GarageArea + GrLivArea, 
               data = house_prices)
summary(model_fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = SalePrice ~ LotArea + GarageArea + GrLivArea, data = house_prices)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -500375  -22148    -977   19699  315357 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -8031.7724  4154.7983  -1.933 0.053414 .  
## LotArea         0.4821     0.1346   3.582 0.000353 ***
## GarageArea    137.0127     6.8638  19.962  &lt; 2e-16 ***
## GrLivArea      78.5759     2.8472  27.597  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 49400 on 1456 degrees of freedom
## Multiple R-squared:  0.6142, Adjusted R-squared:  0.6134 
## F-statistic: 772.6 on 3 and 1456 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="full-model-including-also-interactions-effects" class="section level3">
<h3>Full model (including also interactions effects):</h3>
<pre class="r"><code>model_fit = lm(SalePrice ~ LotArea*GarageArea*GrLivArea, 
               data = house_prices)
summary(model_fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = SalePrice ~ LotArea * GarageArea * GrLivArea, data = house_prices)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -289270  -20605     590   19121  288645 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   8.894e+04  1.229e+04   7.235 7.49e-13 ***
## LotArea                      -2.232e+00  1.166e+00  -1.915  0.05574 .  
## GarageArea                   -9.108e+01  2.109e+01  -4.319 1.68e-05 ***
## GrLivArea                     8.923e+00  7.726e+00   1.155  0.24831    
## LotArea:GarageArea            6.629e-03  1.437e-03   4.614 4.30e-06 ***
## LotArea:GrLivArea             1.935e-03  5.433e-04   3.562  0.00038 ***
## GarageArea:GrLivArea          1.522e-01  1.208e-02  12.599  &lt; 2e-16 ***
## LotArea:GarageArea:GrLivArea -4.305e-06  4.774e-07  -9.016  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 45950 on 1452 degrees of freedom
## Multiple R-squared:  0.667,  Adjusted R-squared:  0.6654 
## F-statistic: 415.5 on 7 and 1452 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code># Note: Have main effects changed?</code></pre>
</div>
</div>
<div id="how-to-visualize-it" class="section level2">
<h2>How to visualize it?</h2>
<pre class="r"><code>ggplot(data = house_prices, aes(x = LotArea, y = SalePrice, color=GarageArea)) +
  geom_jitter(alpha=.2, size=.5) +
  scale_colour_gradient(low = &quot;blue&quot;, high = &quot;gold&quot;, limits=range(house_prices[,&#39;GarageArea&#39;]))</code></pre>
<p><img src="wpa9_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = house_prices, aes(x = GrLivArea, y = SalePrice, color=GarageArea)) +
  geom_jitter(alpha=.2, size=.5) +
  scale_colour_gradient(low = &quot;blue&quot;, high = &quot;gold&quot;, limits=range(house_prices[,&#39;GarageArea&#39;]))</code></pre>
<p><img src="wpa9_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
</div>
<div id="multicollinearity-checks" class="section level2">
<h2>Multicollinearity checks</h2>
<p>From the plots above we can see that the predictors are somewhat correlated. But how can we check this best?</p>
<pre class="r"><code>M = cor(select(house_prices, LotArea, GarageArea, GrLivArea))
M</code></pre>
<pre><code>##              LotArea GarageArea GrLivArea
## LotArea    1.0000000  0.1804028 0.2631162
## GarageArea 0.1804028  1.0000000 0.4689975
## GrLivArea  0.2631162  0.4689975 1.0000000</code></pre>
<p>To more formally test (bewtween 2 variables):</p>
<pre class="r"><code>cor.test(house_prices$GarageArea, house_prices$GrLivArea)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  house_prices$GarageArea and house_prices$GrLivArea
## t = 20.276, df = 1458, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.4279930 0.5080752
## sample estimates:
##       cor 
## 0.4689975</code></pre>
<p>This means that the assumptions were violated and the coefficients should be interpreted with caution.</p>
<div id="hypothesis-tests-for-all-pairwise-correlations" class="section level3">
<h3>Hypothesis tests for all pairwise correlations:</h3>
<pre class="r"><code>#install.packages(&quot;lsr&quot;)

library(lsr)

correlate(as.data.frame(select(house_prices, LotArea, GarageArea, GrLivArea)), test=TRUE)</code></pre>
<pre><code>## 
## CORRELATIONS
## ============
## - correlation type:  pearson 
## - correlations shown only when both variables are numeric
## 
##            LotArea    GarageArea    GrLivArea   
## LotArea          .         0.180***     0.263***
## GarageArea   0.180***          .        0.469***
## GrLivArea    0.263***      0.469***         .   
## 
## ---
## Signif. codes: . = p &lt; .1, * = p&lt;.05, ** = p&lt;.01, *** = p&lt;.001
## 
## 
## p-VALUES
## ========
## - total number of tests run:  3 
## - correction for multiple testing:  holm 
## 
##            LotArea GarageArea GrLivArea
## LotArea          .      0.000     0.000
## GarageArea   0.000          .     0.000
## GrLivArea    0.000      0.000         .
## 
## 
## SAMPLE SIZES
## ============
## 
##            LotArea GarageArea GrLivArea
## LotArea       1460       1460      1460
## GarageArea    1460       1460      1460
## GrLivArea     1460       1460      1460</code></pre>
<p>To better visualize the correlation matrix:</p>
<pre class="r"><code>#install.packages(&quot;corrplot&quot;)

library(&#39;corrplot&#39;)</code></pre>
<pre><code>## corrplot 0.84 loaded</code></pre>
<pre class="r"><code>corrplot(M)</code></pre>
<p><img src="wpa9_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
</div>
<div id="calculating-standardised-regression-coefficients" class="section level2">
<h2>Calculating standardised regression coefficients</h2>
<p>One more thing that you might want to do is to calculate “standardised” regression coefficients: your predictors are often on different scales and this makes it very difficult to compare the coefficients of different predictors.</p>
<p>The standardised coefficients are the coefficients that you would have obtained if you’d converted all the variables to z-scores before running the regression.</p>
<p>You can then either standardize them first, or use the <code>standardCoefs</code> function in R.</p>
<pre class="r"><code>model_fit = lm(SalePrice ~ LotArea+GarageArea+GrLivArea, 
               data = house_prices)
summary(model_fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = SalePrice ~ LotArea + GarageArea + GrLivArea, data = house_prices)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -500375  -22148    -977   19699  315357 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -8031.7724  4154.7983  -1.933 0.053414 .  
## LotArea         0.4821     0.1346   3.582 0.000353 ***
## GarageArea    137.0127     6.8638  19.962  &lt; 2e-16 ***
## GrLivArea      78.5759     2.8472  27.597  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 49400 on 1456 degrees of freedom
## Multiple R-squared:  0.6142, Adjusted R-squared:  0.6134 
## F-statistic: 772.6 on 3 and 1456 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>standardCoefs(model_fit)</code></pre>
<pre><code>##                      b       beta
## LotArea      0.4820601 0.06056669
## GarageArea 137.0127177 0.36874445
## GrLivArea   78.5759048 0.51974818</code></pre>
<pre class="r"><code>house_prices = mutate(house_prices,
                      z_LotArea = scale(LotArea, center = TRUE, scale = TRUE),
                      z_GarageArea = scale(GarageArea, center = TRUE, scale = TRUE),
                      z_GrLivArea = scale(GrLivArea, center = TRUE, scale = TRUE),
                      z_SalePrice = scale(SalePrice, center = TRUE, scale = TRUE))

st_model_fit = lm(z_SalePrice ~ z_LotArea+z_GarageArea+z_GrLivArea, 
               data = house_prices)
summary(st_model_fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = z_SalePrice ~ z_LotArea + z_GarageArea + z_GrLivArea, 
##     data = house_prices)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.2986 -0.2788 -0.0123  0.2480  3.9696 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.779e-16  1.627e-02   0.000 1.000000    
## z_LotArea    6.057e-02  1.691e-02   3.582 0.000353 ***
## z_GarageArea 3.687e-01  1.847e-02  19.962  &lt; 2e-16 ***
## z_GrLivArea  5.197e-01  1.883e-02  27.597  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6218 on 1456 degrees of freedom
## Multiple R-squared:  0.6142, Adjusted R-squared:  0.6134 
## F-statistic: 772.6 on 3 and 1456 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>What happened now to the intercept?</p>
</div>
</div>
<div id="anova" class="section level1">
<h1>2. ANOVA</h1>
<div id="general-linear-models" class="section level2">
<h2>General linear models</h2>
<p>We use linear regression models when we want to predict a continuous variable based on one or more continuous variables, assuming a linear relationship.</p>
<p>But we can also predict a continuous variable based on one or more categorical variables using the ANOVA.</p>
<p>Both linear regression and ANOVA, however, are part of the same category of models: <a href="https://en.wikipedia.org/wiki/General_linear_model">general linear models</a>.</p>
<p>The general linear model or <strong>multivariate regression model</strong> is a statistical linear model. It may be written as:</p>
<p><strong>Y = XB + U</strong>,</p>
<p>where: - <strong>Y</strong> is a matrix with series of multivariate measurements (each column being a set of measurements on one of the dependent variables), - <strong>X</strong> is a matrix of observations on independent variables that might be a design matrix (each column being a set of observations on one of the independent variables), - <strong>B</strong> is a matrix containing parameters that are usually to be estimated - and <strong>U</strong> is a matrix containing errors (noise). The errors are usually assumed to be uncorrelated across measurements, and follow a multivariate normal distribution.</p>
<p>The general linear model incorporates a number of different statistical models: ANOVA, ANCOVA, MANOVA, MANCOVA, ordinary linear regression, t-test and F-test.</p>
</div>
<div id="when-to-use-anovalinear-regression" class="section level2">
<h2>When to use ANOVA/linear regression?</h2>
<p>In practice, we use Analysis of variance (ANOVA) when we have categorical-only predictors. As soon as we have at least one continuous predictor we would switch to linear regression.</p>
<p>The conversion between ANOVA and regression depends on how we code the categorical predictors (see <a href="https://www.theanalysisfactor.com/why-anova-and-linear-regression-are-the-same-analysis/">here</a> for a clear example).</p>
</div>
<div id="different-types-of-anovas" class="section level2">
<h2>Different types of ANOVAS</h2>
<ul>
<li><p><strong>One-way ANOVA</strong> is used to test for differences among two or more independent groups (means), e.g., different levels of urea application in a crop, or different levels of antibiotic action on several different bacterial species, or different levels of effect of some medicine on groups of patients.</p></li>
<li><p>However, should these groups not be independent, and there is an order in the groups (such as mild, moderate and severe disease), or in the dose of a drug (such as 5 mg/mL, 10 mg/mL, 20 mg/mL) given to the same group of patients, then a linear trend estimation should be used. Typically, however, the one-way ANOVA is used to test for differences among at least three groups, since the two-group case can be covered by a t-test. <strong>When there are only two means to compare, the t-test and the ANOVA F-test are equivalent</strong>; the relation between ANOVA and t is given by F = t2.</p></li>
<li><p><strong>Two-way ANOVA</strong> is an extension of the one-way ANOVA that examines the influence of two different categorical independent variables on one continuous dependent variable. The two-way ANOVA not only aims at assessing the main effect of each independent variable but also if there is any interaction between them.</p></li>
<li><p><strong>Repeated measures ANOVA</strong> is used when the same subjects are used for each treatment (e.g., in a longitudinal study).</p></li>
<li><p><strong>Multivariate analysis of variance (MANOVA)</strong> is used when there is more than one response variable.</p></li>
</ul>
</div>
<div id="anovas-assumptions" class="section level2">
<h2>ANOVA’s assumptions</h2>
<p>Because ANOVA and linear regression are <em>essentially</em> the same (see better explanations above), the model’s assumptions are also very similar:</p>
<ul>
<li><strong>Normality</strong>: The residuals are assumed to be normally distributed. As we saw for linear regression, we can assess this by looking at QQ plots or running a Shapiro-Wilk test.</li>
<li><strong>Homogeneity of variance (homoscedasticity)</strong>: ANOVA assumes that the population standard deviation is the same for all groups. We can assess this using the Levene’s test (see below) and visually using a violin or similar plots.</li>
<li><strong>Independence</strong>: the observations should be independent. In case of repeated measures study, you should then use the repeated measure ANOVA (that we don’t cover in this course).</li>
</ul>
</div>
<div id="model-checking-and-fitting" class="section level2">
<h2>Model checking and fitting</h2>
<p>To fit ANOVAs, we use the <code>aov()</code> function.</p>
<p>This function works very similarly to the <code>lm()</code> function: you need a <code>formula</code> argument and a <code>data</code> argument to make it work.</p>
<pre class="r"><code>sub_house_prices = filter(house_prices, Foundation == &quot;Slab&quot; | Foundation == &quot;Stone&quot; | Foundation == &quot;Wood&quot;)

arrange(summarize(group_by(sub_house_prices, Foundation),
          mean_SalePrice = mean(SalePrice),
          sd_SalePrice = sd(SalePrice)),
        mean_SalePrice)</code></pre>
<pre><code>## # A tibble: 3 x 3
##   Foundation mean_SalePrice sd_SalePrice
##   &lt;chr&gt;               &lt;dbl&gt;        &lt;dbl&gt;
## 1 Slab              107366.       34214.
## 2 Stone             165959.       78558.
## 3 Wood              185667.       56695.</code></pre>
<pre class="r"><code>ggplot(data = sub_house_prices, mapping = aes(y = SalePrice, x = Foundation)) +
  geom_violin()</code></pre>
<p><img src="wpa9_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Note that you can also here check whether the normality assumption is violated or not. You can do so by also plotting separate histograms per level of your categorical variable.</p>
<p>More formally:</p>
<pre class="r"><code>shapiro.test(filter(sub_house_prices, Foundation == &quot;Slab&quot;)$SalePrice)</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  filter(sub_house_prices, Foundation == &quot;Slab&quot;)$SalePrice
## W = 0.94837, p-value = 0.2498</code></pre>
<pre class="r"><code>shapiro.test(filter(sub_house_prices, Foundation == &quot;Stone&quot;)$SalePrice)</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  filter(sub_house_prices, Foundation == &quot;Stone&quot;)$SalePrice
## W = 0.74492, p-value = 0.01776</code></pre>
<pre class="r"><code>shapiro.test(filter(sub_house_prices, Foundation == &quot;Wood&quot;)$SalePrice)</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  filter(sub_house_prices, Foundation == &quot;Wood&quot;)$SalePrice
## W = 0.89046, p-value = 0.3558</code></pre>
<p>Levene’s test of equal variance: Low p-value means the variances are not equal.</p>
<p>For the test of equal variances, we need a package called <code>car</code>.</p>
<p>The first argument in the function is thr continuous dependent variable, the second argument is the categorical independent variable.</p>
<pre class="r"><code>#install.packages(&quot;car&quot;)

library(car)</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## Registered S3 methods overwritten by &#39;car&#39;:
##   method                          from
##   influence.merMod                lme4
##   cooks.distance.influence.merMod lme4
##   dfbeta.influence.merMod         lme4
##   dfbetas.influence.merMod        lme4</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     some</code></pre>
<pre class="r"><code>leveneTest(sub_house_prices$SalePrice, sub_house_prices$Foundation) </code></pre>
<pre><code>## Warning in leveneTest.default(sub_house_prices$SalePrice,
## sub_house_prices$Foundation): sub_house_prices$Foundation coerced to factor.</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  2  2.0824 0.1423
##       30</code></pre>
<p>Finally, the actual ANOVA:</p>
<pre class="r"><code>model_fit = aov(SalePrice ~ Foundation, 
                data = sub_house_prices)
summary(model_fit)</code></pre>
<pre><code>##             Df    Sum Sq   Mean Sq F value Pr(&gt;F)   
## Foundation   2 2.857e+10 1.428e+10   6.674  0.004 **
## Residuals   30 6.421e+10 2.140e+09                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>print(model_fit)</code></pre>
<pre><code>## Call:
##    aov(formula = SalePrice ~ Foundation, data = sub_house_prices)
## 
## Terms:
##                  Foundation   Residuals
## Sum of Squares  28569939851 64208950589
## Deg. of Freedom           2          30
## 
## Residual standard error: 46263.36
## Estimated effects may be unbalanced</code></pre>
</div>
<div id="tukeys-honest-significant-difference-test" class="section level2">
<h2>Tukey’s honest significant difference test</h2>
<p>Note that ANOVA tests the null hypothesis that the means in all our groups are equal. A rejection of this null hypothesis means that there is a significant difference in at least one of the possible pairs of means.</p>
<p>To get an idea of which pair of means contains a significant difference, we can follow up with Tukey’s test that will give us all pairwise comparisons.</p>
<p>Tukey’s test corrects the p-values upwards — so it is more conservative in deciding something is significant — because the comparisons are post-hoc or exploratory:</p>
<pre class="r"><code>TukeyHSD(model_fit, &quot;Foundation&quot;)</code></pre>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = SalePrice ~ Foundation, data = sub_house_prices)
## 
## $Foundation
##                diff        lwr      upr     p adj
## Stone-Slab 58593.54   6536.288 110650.8 0.0247988
## Wood-Slab  78301.04   8458.907 148143.2 0.0254424
## Wood-Stone 19707.50 -60939.251 100354.3 0.8198692</code></pre>
</div>
</div>
<div id="now-its-your-turn" class="section level1">
<h1>3. Now it’s your turn</h1>
<div id="student-performance" class="section level2">
<h2>Student Performance</h2>
<p>From github, get the <code>student-mat.csv</code> and <code>student-por.csv</code> datasets.</p>
<p><strong>Task A</strong></p>
<ol style="list-style-type: decimal">
<li><p>Using the <code>student_math</code> dataset, create a regression object called <code>model_fit_1</code> predicting third period grade (G3) based on sex, age, internet, and failures. How do you interpret the regression output? Which variables are significantly related to third period grade?</p></li>
<li><p>Check the model’s assumptions. Which are violated?</p></li>
<li><p>Load the <code>student-por.csv</code> in R as <code>student_port</code>. Inspect the dataset first.</p></li>
<li><p>Create a new regression object called <code>model_fit_2</code> using the same variables as question 1: however, this time use the portugese dataset.</p></li>
<li><p>What are the key differences between the beta values for the portugese dataset (<code>model_fit_2</code>) and the math dataset (<code>model_fit_1</code>)?</p></li>
</ol>
<p><strong>Task B</strong></p>
<ol style="list-style-type: decimal">
<li><p>Using the <code>student_math</code> dataset, create a regression object called <code>model_fit_3</code> predicting first period grade (G1) based on guardian. Guardian is a nominal variable with 3 levels.</p></li>
<li><p>Use <code>summary</code> to look at the output. You should see 2 predictors listed (“guardianmother” and “guardiananother”), rather than the expected 1 (“guardian”). <code>lm</code> has dummy coded your variables with “father” set as the reference group. Look at the levels of the guardian factor to see why “father” is the reference group. How would you interpret the results?</p></li>
<li><p>What is the predicted grade for those with a father as their guardian? Those with a mother? Those with other? Compare these to the means of each group again.</p></li>
</ol>
<p><strong>Task C</strong></p>
<ol style="list-style-type: decimal">
<li><p>Using the <code>student_math</code> dataset, create a regression object called <code>model_fit_4</code> predicting a student’s first period grade (G1) based on all variables in the dataset (<em>Hint</em>: use the notation <code>formula = y ~ .</code> to include all variables)</p></li>
<li><p>Save the fitted values from the <code>model_fit_4</code> object as a vector called <code>model_4_fitted</code>.</p></li>
<li><p>Using the <code>student_math</code> dataset, create a scatterplot showing the relationship between a student’s first period grade (G1) and the fitted values from the model. Does the model appear to correctly fit a student’s first period grade? Use <code>geom_abline()</code> with <code>slope=1</code> and <code>intercept=0</code> to plot the identity line and better answer to this question.</p></li>
<li><p>Create a new regression object, called <code>model_fit_5</code> which doesn’t include G2 or G3 as predictors, but still includes all other variables. Save the fitted values from the <code>model_fit_5</code> object as a vector called <code>model_5_fitted</code>.</p></li>
<li><p>Plot the predicted grades against the actual ones, as predicted by model <code>model_fit_5</code>, as in question 3. How well does the new model perform now?</p></li>
</ol>
<p><strong>Task D</strong></p>
<ul>
<li><p>For each question, conduct the appropriate ANOVA. Write the conclusion in APA style. To summarize an effect in an ANOVA, use the format F(XXX, YYY) = FFF, p = PPP, where XXX is the degrees of freedom of the variable you are testing, YYY is the degrees of freedom of the residuals, FFF is the F value for the variable you are testing, and PPP is the p-value. If the p-value is less than .01, just write p &lt; .01.</p></li>
<li><p>For the purposes of this class, if the p-value of the ANOVA is less than .05, conduct post-hoc tests. If you are only testing one independent variable, write APA conclusions for the post-hoc test. <strong>If you are testing more than one independent variable in your ANOVA, you do not need to write APA style conclusions for post-hoc tests – just comment the result.</strong></p></li>
</ul>
<p>For example, here is how you would analyze and answer the question: “Was there an effect of diets on Chicken Weights?”"</p>
<pre><code># ANOVA on Chicken Weights
#   IV = Diet, DV = weight

# ANOVA
model_fit = aov(formula = weight ~ Diet, data = ChickWeight)

summary(model_fit)

# ANOVA was significant (p &lt; .01), so I&#39;ll conduct post-hoc tests

# Tukey post-hoc tests
TukeyHSD(model_fit)

# There was a significant main effect of diets on chicken weights (F(3, 574) = 10.81, p &lt; .01). 
# Pairwise Tukey HSD tests showed significant differences between diets 1 and 3 (diff = 40.30, p &lt; .01) 
# and diets 1 and 4 (diff = 32.62, p &lt; .01). 
# All other pairwise differences were not significant at the 0.05 significance threshold.</code></pre>
<ol style="list-style-type: decimal">
<li><p>Using the <code>student_math</code> dataset, was there a main effect of the school support on G1? Conduct a one-way ANOVA. If the result is significant (p &lt; .05), conduct post-hoc tests.</p></li>
<li><p>Using the <code>student_math</code> dataset, was there a main effect of the family support on G1? Conduct a one-way ANOVA. If the result is significant (p &lt; .05), conduct post-hoc tests.</p></li>
<li><p>Conduct a two-way ANOVA on G1 with both school support and family support as IVs. Do your results for each variable change compared to your previous one-way ANOVAs on these variables? (You do not need to give APA results or conduct post-hoc tests, just answer the question verbally).</p></li>
</ol>
</div>
<div id="submit-your-assignment" class="section level2">
<h2>Submit your assignment</h2>
<p>Save and email your script to me at <a href="mailto:laura.fontanesi@unibas.ch">laura.fontanesi@unibas.ch</a> by the end of <strong>Friday</strong>.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
